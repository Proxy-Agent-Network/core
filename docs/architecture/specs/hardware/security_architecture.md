# Hardware Root of Trust: TPM 2.0 & Lightning Integration

**Status:** Draft Specification (v1)  
**Target Hardware:** Raspberry Pi 5 + Infineon OPTIGAâ„¢ TPM SLB 9670

---

## Abstract
To prevent "Sybil Attacks" where a single human simulates multiple physical nodes, Proxy Protocol relies on a Hardware Root of Trust. This document details how the Trusted Platform Module (TPM) interacts with the Lightning Network Daemon (LND) to cryptographically sign physical proofs without the private key ever entering system RAM.

---

## 1. Key Generation Ceremony
Unlike standard software wallets, the Node's identity key is never generated by the OS.

1.  **On-Boarding:** The Node software sends a `$TPM2\_CreatePrimary$` command.
2.  **Generation:** The Infineon chip generates an ECC (Elliptic Curve) key pair inside its shielded secure element.
3.  **Export:** The Public Key is exported to the Proxy Registry.
4.  **Sealing:** The Private Key is permanently sealed inside the hardware. It cannot be extracted, cloned, or backed up.

---

## 2. Remote Signing for Lightning
The Proxy Node operates as a Remote Signer for the Lightning Network.

* **The Challenge:** To settle a task (claim funds), the Node must sign a specific invoice preimage.
* **The Flow:**
    1.  Agent sends 500 Sats to a HODL Invoice locked to the Node's Public Key.
    2.  Node completes task (e.g., scans mail).
    3.  Node software hashes the scan data.
    4.  Node sends the hash into the TPM.
    5.  TPM signs the hash with the private key.
    6.  Signed payload is broadcast to the Lightning Network to claim the funds.

---

## 3. Anti-Tamper & Intrusion Detection
The Reference Node chassis includes a standard GPIO intrusion switch (**Circuit Closed = Safe**).

### The "Dead Man's Switch" Logic
If the chassis is opened (**Circuit Open**):

1.  The GPIO interrupt fires.
2.  The kernel triggers a `$TPM2\_Clear$` command immediately.
3.  The cryptographic identity is wiped.
4.  The Node is effectively "bricked" and must be re-registered as a new Tier 0 entity.

> [!CAUTION]
> **Security Note:** This prevents a malicious actor from stealing a verified Node and extracting its secrets to run a bot farm. Physical security is the root of the Proxy Protocol's trust model.
